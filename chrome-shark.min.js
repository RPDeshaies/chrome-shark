var ChromeShark=function(){function b(){function d(){return this.playerInfo&&this.playerInfo.GetSong()&&0!=this.playerInfo.GetSong().length||(this.playerInfo=this.chromeSharkInterface==this.Interface.Grooveshark?{GetSong:function(){return c("#now-playing-metadata .song")},GetArtist:function(){return c("#now-playing-metadata .artist")},GetTimeElapsed:function(){return c("#now-playing #time-elapsed")},GetTimeTotal:function(){return c("#now-playing #time-total")},GetControls:function(){return c("#play-controls")}}:{GetSong:function(){return c("iframe#app-player").contents().find("#track-name")},GetArtist:function(){return c("iframe#app-player").contents().find("#track-artist")},GetTimeElapsed:function(){return c("iframe#app-player").contents().find("#track-current")},GetTimeTotal:function(){return c("iframe#app-player").contents().find("#track-length")},GetControls:function(){return c("iframe#app-player").contents().find("#controls")}}),this.playerInfo.GetSong()&&0!=this.playerInfo.GetSong().length}function e(b){var d=this;this.chromeSharkInterface==this.Interface.Grooveshark&&(b=b||c(".chrome-shark-meta-data-container"),b&&(d.$playControls=d.playerInfo.GetControls().clone().removeAttr("id").addClass("chrome-shark-track-controls-button").css({"margin-left":"auto","margin-right":"auto","margin-bottom":"50px",width:"90px"}),d.$playControls.find("a").click(function(){var a=c(this),b=c("#"+a.attr("id"));b.click()}),d.$playControls.find("#play-pause").click(function(){c(this).toggleClass("playing")}),c(".chrome-shark-track-controls-button").remove(),b.find(".chrome-shark-progress-bar-container").before(this.$playControls)),clearTimeout(d.updatePlayerControlsTimeout),d.updatePlayerControlsTimeout=setTimeout(function(){e.call(d)},a.updateTimePlayerControls))}function f(){var b=this,e=d.call(b);if(e){var h=b.playerInfo.GetSong().text(),i=b.playerInfo.GetArtist().text(),j=b.playerInfo.GetTimeElapsed().text().trim()||"0:00",k=b.playerInfo.GetTimeTotal().text().trim()||"0:00";if(h&&i){if(c(".chrome-shark-track-info").show(),c(".chrome-shark-track-no-info").hide(),c(".chrome-shark-track-controls").show(),c(".chrome-shark-title").text()!=h&&c(".chrome-shark-title").text(this.songTitle),c(".chrome-shark-artist").text()!=i&&c(".chrome-shark-artist").text(this.artist),c(".chrome-shark-time-elapsed").text()!=j){c(".chrome-shark-time-elapsed").text(this.timeElapsed);var l=0;if(this.timeElapsed&&this.timeTotal){var m=new RegExp("[0-9]+","g"),n=parseInt(j.match(m)[0]),o=parseInt(j.match(m)[1]),p=parseInt(k.match(m)[0]),q=parseInt(k.match(m)[1]);l=100*((60*n+o)/(60*p+q))}var r=c(".chrome-shark-progress-bar-current-progress");r&&r.css({width:l+"%"})}c(".chrome-shark-time-total").text()!=k&&c(".chrome-shark-time-total").text(this.timeTotal);var s=!1;if(h!=this.songTitle&&(this.songTitle=h,s=!0),i!=this.artist&&(this.artist=i),s&&g.call(b),c(".chrome-shark-album-art")&&c(".chrome-shark-album-art").attr("src")!=this.albumArtUrl&&!this.currentlyLoadingImage){this.currentlyLoadingImage=!0;var t=c(".chrome-shark-album-art").clone();t.attr("src",this.albumArtUrl).hide(),t.load(function(){b.currentlyLoadingImage=!1,c(".chrome-shark-album-art").after(t).remove(),c(".chrome-shark-album-art").stop(!0,!0).show()})}k!=this.timeTotal&&(this.timeTotal=k),j!=this.timeElapsed&&(this.timeElapsed=j)}else c(".chrome-shark-track-info").hide(),c(".chrome-shark-track-no-info").show(),c(".chrome-shark-track-controls").hide()}clearTimeout(this.updateMetaDataTimeout),this.updateMetaDataTimeout=setTimeout(function(){f.call(b)},a.updateTimeMetaData)}function g(){var b=this;c.ajax("https://ws.audioscrobbler.com/2.0/?method=track.getInfo&api_key="+a.lastFmApiKey+"&artist="+encodeURI(b.artist)+"&track="+encodeURI(b.songTitle)+"&format=json",{success:function(d){var e=d.track,f=a.defaultAlbumArtUrl;if(e&&e.album){var g=e.album.image[e.album.image.length-1]["#text"];if(-1==g.indexOf("noimage")){var h=new RegExp("serve/.+/","g");f=g.replace(h,"serve/_/")}}b.albumArtUrl=f,c.ajax("https://ws.audioscrobbler.com/2.0/?method=artist.getInfo&api_key="+a.lastFmApiKey+"&artist="+encodeURI(b.artist)+"&format=json",{success:function(d){if(d&&d.artist){if(d.artist.image){var e=d.artist,f=e.image[e.image.length-1]["#text"];b.albumArtUrl==a.defaultAlbumArtUrl&&f&&(b.albumArtUrl=f)}e.bio.summary?(c(".chrome-shark-artist-bio-summary").html(e.bio.summary),b.artistBio=e.bio.summary,c(".chrome-shark-artist-bio-summary").find("a").css({color:"#4A4A4A"}),c(".chrome-shark-artist-bio").show()):(c(".chrome-shark-artist-bio-summary").empty(),c(".chrome-shark-artist-bio").hide(),b.artistBio="")}}})}})}function h(){var a=this;this.GetDependencies(function(){a.DetectInterfaceType(),d.call(a),f.call(a),a.Show()})}var c=null;this.songTitle="",this.artist="",this.artistBio="",this.timeElapsed="",this.timeTotal="",this.$playControls=null,this.currentlyLoadingImage=!1,this.updateMetaDataTimeout=null,this.updatePlayerControlsTimeout=null,this.playerInfo=void 0,this.chromeSharkInterface=void 0,this.Show=function(){var b=this;if(this.IsUICreated())c(".chrome-shark").show();else{var d=c("<div class='chrome-shark'>").css({display:"block",position:"fixed",width:"100%",height:"100%",left:"0",top:"0","z-index":"99999999999"}),g=c("<div class=chrome-shark-album-art-container>").css({display:"block",width:"55%",height:"100%",background:"linear-gradient(#111119 0%, #0C3A5F 100%)","z-index":"99999999999","float":"left"}),h=c("<img class='chrome-shark-album-art'>").css({width:"100%",height:"100%"});b.albumArtUrl=a.defaultAlbumArtUrl,h.attr("src",a.defaultAlbumArtUrl),g.append(h);var i=c("<div class='chrome-shark-meta-data-container'>").css({padding:"20px","background-color":"#FFF",margin:"80px 50px 20px 50px",display:"block",position:"absolute",height:"auto",bottom:"0",top:"0",left:"0",right:"0","border-radius":"10px","min-width":"400px","min-height":"270px","overflow-y":"auto"}),j=c("<span>Now playing | <a class='chrome-shark-close-button'>Close</a></span>").css({color:"white","float":"right","padding-top":"10px","font-size":"12pt","font-weight":"normal"});j.find(".chrome-shark-close-button").css({color:"#00B0D0"}),c(document).keyup(function(a){27===a.keyCode&&b.ToggleShow()}),j.find(".chrome-shark-close-button").click(function(a){a.preventDefault(),b.Close()});var k=c("<div class='chrome-shark-toolbar'>").css({transform:"translateZ(0)",padding:"12px","-ms-transition":".3s","background-image":"linear-gradient(top, #333, #222)",filter:"progid:DXImageTransform.Microsoft.Gradient(startColorstr='#ff333333', endColorstr='#ff222222', GradientType=0)","-webkit-transform":"translateZ(0)","-moz-transform":"translateZ(0)","-ms-transform":"translateZ(0)","min-width":"400px","text-align":"left"}).append(j).append("<span class='logo-chrome-shark'><span class='logo-chrome'>Chrome </span><span class='logo-shark'>Shark</span></span>");i.append("<div class='chrome-shark-track-info'>    <span>        <span class='chrome-shark-title'></span>        <div class='chrome-shark-artist-container'>            <span class='chrome-shark-artist-prefix'>by </span><span class='chrome-shark-artist'></span>        </div>    </span></div><div class='chrome-shark-track-controls'>     <span class='chrome-shark-time-elapsed-total' style='color:white'>        <span class='chrome-shark-time-elapsed'></span> / <span class='chrome-shark-time-total'></span>    </span>    <div class='chrome-shark-progress-bar-container'>     <div class='chrome-shark-progress-bar'>       <div class='chrome-shark-progress-bar-current-progress'>       </div>     </div>    </div></div><div class='chrome-shark-artist-bio' style='display:none'> <span class='chrome-shark-artist-summary-title'>Artist summary </span> <p class='chrome-shark-artist-bio-summary'></p></div><div class='chrome-shark-track-no-info'> <span>No songs are currently playing. </br>Close Chrome-Shark and add some ! </span></div>"),k.find(".logo-chrome").css({"font-family":'"Helvetica Neue",Helvetica,Arial,sans-serif',"font-style":"normal",color:"#00B0D0","font-size":"20pt"}),k.find(".logo-shark").css({"font-family":'"Helvetica Neue",Helvetica,Arial,sans-serif',"font-style":"normal",color:"#adadad","font-size":"20pt"}),i.find(".chrome-shark-title").css({"font-size":"20pt","line-height":"30px"}),i.find(".chrome-shark-artist-container").css({"font-weight":"lighter","font-size":"15pt","margin-top":"15px"}),i.find(".chrome-shark-artist-summary-title").css({"font-size":"20pt","line-height":"30px"}),i.find(".chrome-shark-track-controls").css({"margin-top":"10%",position:"relative",width:"100%","background-color":"#181818",padding:"15px","box-sizing":"border-box","ms-box-sizing":"border-box","webkit-box-sizing":"border-box","moz-box-sizing":"border-box","border-radius":"7px",color:"white","margin-bottom":"40px","min-height":"100px"}),i.find(".chrome-shark-track-controls .chrome-shark-time-elapsed-total").css({color:"#FFF","font-size":"26px","text-align":"center","margin-top":"10px"}),i.find(".chrome-shark-progress-bar").css({"background-color":"#4E4E4E",height:"8px",width:"100%","border-radius":"4px",position:"relative",margin:"10px 0px 10px 0px"}),i.find(".chrome-shark-progress-bar-current-progress").css({position:"absolute",top:"0",left:"0",width:"0px","background-color":"#007ACC",height:"8px","border-radius":"4px"}),e.call(this,i),i.find(".chrome-shark-artist-bio-summary").css({"font-size":"12pt","line-height":"20pt","font-weight":"bold"});var l=c("<div class=chrome-shark-meta-data>").css({display:"block",width:"45%",height:"100%","z-index":"99999999999","float":"right",position:"relative","font-family":"sans-serif","text-align":"center",background:"linear-gradient(#111119 0%, #0C3A5F 100%)",filter:"progid:DXImageTransform.Microsoft.gradient( startColorstr='#000c1f', endColorstr='#00203a',GradientType=0 )"}).append(k).append(i);d.append(g).append(l),c("body").after(d)}f.call(this),this.Flip(!0)},this.Flip=function(b){if(!b){var d=c(".chrome-shark-meta-data").css("float"),e="";e="left"==d?"right":"left",c(".chrome-shark-meta-data").css("float",e),c(".chrome-shark-album-art-container").css("float",d)}var f=this;clearTimeout(this.flipTimeout),this.flipTimeout=setTimeout(function(){f.Flip()},a.flipTime)},this.IsUICreated=function(){var a=c(".chrome-shark");return a&&a.length>0},this.IsUIVisible=function(){var a=c(".chrome-shark");return a&&a.is(":visible")},this.Close=function(){clearTimeout(this.updateMetaDataTimeout),clearTimeout(this.flipTimeout),c(".chrome-shark").hide()},this.DetectInterfaceType=function(){this.chromeSharkInterface=this.Interface.Grooveshark,-1==location.host.indexOf("grooveshark")&&(this.chromeSharkInterface=this.Interface.Spotify)},this.GetDependencies=function(a){if(window.jQuery)c=jQuery,a();else{var d=document.createElement("script");d.src="",b.prototype.GetScript("//ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js",function(){jQuery.noConflict(),c=jQuery,a()})}},h.call(this)}var a={updateTimeMetaData:200,updateTimePlayerControls:3e3,flipTime:3e5,defaultAlbumArtUrl:"http://cdn.last.fm/flatness/responsive/2/noimage/default_album_300_g4.png",lastFmApiKey:"ad333b16177f470aa55bd705557d5727",lastFmSecret:"0ec337aaa1272e22a3c9f86c76480461"};return b.prototype.ToggleShow=function(){this.IsUIVisible()?this.Close():this.Show()},b.prototype.GetScript=function(a,b){var c=document.createElement("script");c.type="text/javascript",c.src=a,c.onload=b,c.onreadystatechange=function(){"complete"==this.readyState&&b()},document.body.appendChild(c)},b.prototype.Interface={Grooveshark:0,Spotify:1},b}();if("undefined"!=typeof ChromeShark)window.chromeShark?window.chromeShark.ToggleShow():window.chromeShark=new ChromeShark;else{var url=location.protocol+"//tareck117.github.io/chrome-shark/js/app/chrome-shark.min.js",script=document.createElement("script");script.setAttribute("language","JavaScript"),script.setAttribute("src",url+"?rand="+(new Date).getTime()),document.body.appendChild(script)}